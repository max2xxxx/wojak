class WSDB{constructor(){return this.db=!1,this.actualVersion=1,{init:new Promise((s,t)=>{Dexie.getDatabaseNames(t=>{if(t.indexOf("wojakstudio")<0&&(console.log("CREATE DB"),s(this.initDB())),t.indexOf("wojakstudio")>=0){let t=new Dexie("wojakstudio");t.open().then(()=>{t.verno!==this.actualVersion?s(this.updateDB()):s(this.initDB())})}})}),tools:this}}initDB(){return console.log("INIT DB"),this.db=new Dexie("wojakstudio"),this.db.version(this.actualVersion).stores({user:"id,lang,theme",custom_images:"id,base64,name",saved_compositions:"id,name,jsondata,base64",system:"id,version"}),this.db.system.put({id:1,version:this.actualVersion}),this.db}updateDB(){return console.log("MAJ DB"),this.initDB(),this.db.system.update(1,{version:this.actualVersion}),this.db}getNextId(s){return new Promise(t=>{this.db[s].count(s=>{t(s+1)})})}}